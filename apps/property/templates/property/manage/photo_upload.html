{% extends 'portal_base.html' %}
{% block title %}Photo Upload{% endblock %}
{% block contents %}

<div class="dashboard_content">
    <div class="dashboard_add_property">
        <div class="add_property_info wow fadeInUp" data-wow-duration="1.5s">
            <h5 class="mb-3">{{ property.title }}</h5>
            <hr>

            {% if messages %}
            <div class="mt-3">
                {% for message in messages %}
                <div class="alert alert-{{ message.tags }}" style="color: red;">
                    {{ message }}
                </div>
                {% endfor %}
            </div>
            {% endif %}

            <form method="POST" enctype="multipart/form-data" class="mb-4 p-3 border rounded bg-light shadow-sm">
                {% csrf_token %}

                <label class="fw-bold mb-2">Select Photos</label>

                <input type="file" name="photos" multiple class="form-control" accept="image/jpeg,image/png" required>

                <small class="text-muted d-block mt-1" style="font-size: 12px;">
                    Allowed formats: JPG, JPEG, PNG | Max size: 5MB per file
                </small>

                <button class="btn btn-primary mt-3">
                    Upload Photos
                </button>
            </form>

            <hr>

            <div class="row g-3">
                {% for p in property.photos.all %}
                <div id="photo-{{ p.id }}" class="col-6 col-md-3">
                    <div class="photo-box position-relative">
                        <img src="{{ p.image.url }}" class="photo-img" alt="">
                        <button hx-post="{% url 'property:photo_delete' p.id %}" hx-include="[name=csrfmiddlewaretoken]"
                            hx-confirm="Are you sure you want to delete this photo?" hx-target="#photo-{{ p.id }}"
                            hx-swap="outerHTML" class="delete-btn btn btn-danger btn-sm">
                            Delete
                        </button>
                    </div>
                </div>
                {% endfor %}
            </div>

        </div>
    </div>
</div>

<style>
    .photo-box {
        width: 100%;
        height: 200px;
        position: relative;
        overflow: hidden;
        border-radius: 10px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
    }

    .photo-img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 10px;
    }

    .delete-btn {
        position: absolute;
        bottom: 8px;
        right: 8px;
        z-index: 10;
        padding: 5px 10px;
        font-size: 12px;
        border-radius: 6px;
    }
</style>
{% endblock %}